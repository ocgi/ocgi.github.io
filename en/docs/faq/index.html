<!doctype html><html lang=en-us><head><meta charset=utf-8><title>Frequently Asked Questions</title><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=generator content="Hugo 0.83.1"><link rel=stylesheet href=https://ocgi.github.io/plugins/bootstrap/bootstrap.min.css><link rel=stylesheet href=https://ocgi.github.io/plugins/themify-icons/themify-icons.css><link rel=icon href=https://ocgi.github.io/images/favicon.png type=image/x-icon><link href="https://fonts.googleapis.com/css?family=Lato:300,400,700&display=swap" rel=stylesheet><style>:root{--primary-color:#0052d9;--body-color:#f9f9f9;--text-color:#636363;--text-color-dark:#242738;--white-color:#ffffff;--light-color:#f8f9fa;--font-family:Lato}</style><link href=https://ocgi.github.io/css/style.min.css rel=stylesheet media=screen><script src=https://ocgi.github.io/plugins/jquery/jquery-1.12.4.js></script><script src=https://ocgi.github.io/plugins/jquery/jquery-ui.js></script><script src=https://ocgi.github.io/plugins/bootstrap/bootstrap.min.js></script><script src=https://ocgi.github.io/plugins/match-height/jquery.matchHeight-min.js></script></head><body><header class="shadow-bottom sticky-top bg-white"><nav class="navbar navbar-expand-md navbar-light"><div class=container><a class="navbar-brand px-2" href=/>OCGI</a>
<button class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#navigation aria-controls=navigation aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse text-center" id=navigation><ul class="navbar-nav ml-auto"><li class=nav-item><a class="nav-link text-dark" href=https://ocgi.github.io/en/docs/>Docs</a></li><li class=nav-item><a class="nav-link text-dark" href=https://github.com/ocgi>Github</a></li></ul><select class="lang-list dark" id=select-language onchange="location=this.value"><option id=en value=https://ocgi.github.io/en/docs/faq/ selected>En</option></select></div></div></nav></header><section class="single section-sm pb-0"><div class=container><div class=row><div class=col-lg-3><div class=sidebar><ul class=list-styled><a class=back-btn href=/></a><li data-nav-id=https://ocgi.github.io/en/ title=Ens class=sidelist><a href=https://ocgi.github.io/en/>Ens</a><ul><li data-nav-id=https://ocgi.github.io/en/docs/ title="OCGI Documentation" class=sidelist><a href=https://ocgi.github.io/en/docs/>OCGI Documentation</a><ul><li data-nav-id=https://ocgi.github.io/en/docs/overview/ title=Overview class=sidelist><a href=https://ocgi.github.io/en/docs/overview/>Overview</a></li><li data-nav-id=https://ocgi.github.io/en/docs/installation/ title=Installation class=sidelist><a href=https://ocgi.github.io/en/docs/installation/>Installation</a></li><li data-nav-id=https://ocgi.github.io/en/docs/getting-started/ title="Getting Started" class=sidelist><a href=https://ocgi.github.io/en/docs/getting-started/>Getting Started</a><ul><li data-nav-id=https://ocgi.github.io/en/docs/getting-started/gameserver/ title="Create a GameServer" class=sidelist><a href=https://ocgi.github.io/en/docs/getting-started/gameserver/>Create a GameServer</a></li><li data-nav-id=https://ocgi.github.io/en/docs/getting-started/squad/ title="Create a Squad" class=sidelist><a href=https://ocgi.github.io/en/docs/getting-started/squad/>Create a Squad</a></li><li data-nav-id=https://ocgi.github.io/en/docs/getting-started/gpa/ title="Create a GeneralPodAutoscaler" class=sidelist><a href=https://ocgi.github.io/en/docs/getting-started/gpa/>Create a GeneralPodAutoscaler</a></li></ul></li><li data-nav-id=https://ocgi.github.io/en/docs/guides/ title=Guides class=sidelist><a href=https://ocgi.github.io/en/docs/guides/>Guides</a><ul><li data-nav-id=https://ocgi.github.io/en/docs/guides/squad_details/ title="Squad Introduction" class=sidelist><a href=https://ocgi.github.io/en/docs/guides/squad_details/>Squad Introduction</a></li><li data-nav-id=https://ocgi.github.io/en/docs/guides/gpa/ title="GeneralPodAutoscaler Introduction" class=sidelist><a href=https://ocgi.github.io/en/docs/guides/gpa/>GeneralPodAutoscaler Introduction</a></li><li data-nav-id=https://ocgi.github.io/en/docs/guides/autoscaling_flow/ title="GameServer autoscaling workflow" class=sidelist><a href=https://ocgi.github.io/en/docs/guides/autoscaling_flow/>GameServer autoscaling workflow</a></li><li data-nav-id=https://ocgi.github.io/en/docs/guides/squad-scaledown-priority/ title="GamerServer scaling down priority" class=sidelist><a href=https://ocgi.github.io/en/docs/guides/squad-scaledown-priority/>GamerServer scaling down priority</a></li></ul></li><li data-nav-id=https://ocgi.github.io/en/docs/reference/ title=Reference class=sidelist><a href=https://ocgi.github.io/en/docs/reference/>Reference</a><ul><li data-nav-id=https://ocgi.github.io/en/docs/reference/sdk/ title="Carrier SDK" class=sidelist><a href=https://ocgi.github.io/en/docs/reference/sdk/>Carrier SDK</a></li><li data-nav-id=https://ocgi.github.io/en/docs/reference/gpa_webhook/ title="GPA Webhook example" class=sidelist><a href=https://ocgi.github.io/en/docs/reference/gpa_webhook/>GPA Webhook example</a></li></ul></li><li data-nav-id=https://ocgi.github.io/en/docs/examples/ title=Examples class=sidelist><a href=https://ocgi.github.io/en/docs/examples/>Examples</a></li><li data-nav-id=https://ocgi.github.io/en/docs/faq/ title="Frequently Asked Questions" class="sidelist
active"><a href=https://ocgi.github.io/en/docs/faq/>Frequently Asked Questions</a></li></ul></li></ul></li></ul></div></div><div class=col-lg-9><div class="p-lg-5 p-4 bg-white"><h1 class=mb-5>Frequently Asked Questions</h1><div class=content><h2 id=how-many-historical-versions-does-squad-keep>How many historical versions does Squad keep?</h2><p><code>Squad.Spec.RevisionHistoryLimit</code> controls the number of historical versions of Squad, and the default is 10.</p><h2 id=when-squad-scaling-up-is-the-replicas-created-serially-or-concurrently>When Squad scaling-up, is the replicas created serially or concurrently?</h2><p>Squad controls the number of copies of GameServer through GameServerSet. When adding copies, multiple (16) Goroutines concurrently create GameServer:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>c</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Controller</span>) <span style=color:#a6e22e>addMoreGameServers</span>(<span style=color:#a6e22e>gsSet</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>carrierv1alpha1</span>.<span style=color:#a6e22e>GameServerSet</span>, <span style=color:#a6e22e>count</span> <span style=color:#66d9ef>int</span>) <span style=color:#66d9ef>error</span> {
	<span style=color:#a6e22e>klog</span>.<span style=color:#a6e22e>Infof</span>(<span style=color:#e6db74>&#34;Adding more gameservers: %v, count: %v&#34;</span>, <span style=color:#a6e22e>gsSet</span>.<span style=color:#a6e22e>Name</span>, <span style=color:#a6e22e>count</span>)

	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>parallelize</span>(<span style=color:#a6e22e>newGameServersChannel</span>(<span style=color:#a6e22e>count</span>, <span style=color:#a6e22e>gsSet</span>), <span style=color:#a6e22e>maxCreationParalellism</span>, <span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>gs</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>carrierv1alpha1</span>.<span style=color:#a6e22e>GameServer</span>) <span style=color:#66d9ef>error</span> {
		<span style=color:#a6e22e>gameservers</span>.<span style=color:#a6e22e>ApplyDefaults</span>(<span style=color:#a6e22e>gs</span>)
		<span style=color:#a6e22e>gs</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>gameServerGetter</span>.<span style=color:#a6e22e>GameServers</span>(<span style=color:#a6e22e>gs</span>.<span style=color:#a6e22e>Namespace</span>).<span style=color:#a6e22e>Create</span>(<span style=color:#a6e22e>gs</span>)
		<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
			<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>errors</span>.<span style=color:#a6e22e>Wrapf</span>(<span style=color:#a6e22e>err</span>, <span style=color:#e6db74>&#34;error creating gameserver for gameserverset %s&#34;</span>, <span style=color:#a6e22e>gsSet</span>.<span style=color:#a6e22e>Name</span>)
		}

		<span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>stateCache</span>.<span style=color:#a6e22e>forGameServerSet</span>(<span style=color:#a6e22e>gsSet</span>).<span style=color:#a6e22e>created</span>(<span style=color:#a6e22e>gs</span>)
		<span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>recorder</span>.<span style=color:#a6e22e>Eventf</span>(<span style=color:#a6e22e>gsSet</span>, <span style=color:#a6e22e>corev1</span>.<span style=color:#a6e22e>EventTypeNormal</span>, <span style=color:#e6db74>&#34;SuccessfulCreate&#34;</span>, <span style=color:#e6db74>&#34;Created gameserver: %s&#34;</span>, <span style=color:#a6e22e>gs</span>.<span style=color:#a6e22e>Name</span>)
		<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>
	})
}
</code></pre></div><h2 id=check-deleteablegates-when-squad-is-updated>Check DeleteableGates when Squad is updated</h2><p>When Squad is scaling-down and deleting GameServer, it will check the <code>DeleteableGates</code> condition. Only when all the <code>DeleteableGates</code> condition will be <code>True</code> (controlled by the application), will the corresponding GameServer be deleted:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=color:#75715e>// IsDeletable returns false if the server is currently not deletable
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>IsDeletable</span>(<span style=color:#a6e22e>gs</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>carrierv1alpha1</span>.<span style=color:#a6e22e>GameServer</span>) <span style=color:#66d9ef>bool</span> {
	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>IsBeforeReady</span>(<span style=color:#a6e22e>gs</span>) {
		<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>
	}
	<span style=color:#a6e22e>condMap</span> <span style=color:#f92672>:=</span> make(<span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#a6e22e>carrierv1alpha1</span>.<span style=color:#a6e22e>ConditionStatus</span>, len(<span style=color:#a6e22e>gs</span>.<span style=color:#a6e22e>Status</span>.<span style=color:#a6e22e>Conditions</span>))
	<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>condition</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>gs</span>.<span style=color:#a6e22e>Status</span>.<span style=color:#a6e22e>Conditions</span> {
		<span style=color:#a6e22e>condMap</span>[string(<span style=color:#a6e22e>condition</span>.<span style=color:#a6e22e>Type</span>)] = <span style=color:#a6e22e>condition</span>.<span style=color:#a6e22e>Status</span>
	}
	<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>gate</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>gs</span>.<span style=color:#a6e22e>Spec</span>.<span style=color:#a6e22e>DeletableGates</span> {
		<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>v</span>, <span style=color:#a6e22e>ok</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>condMap</span>[<span style=color:#a6e22e>gate</span>]; !<span style=color:#a6e22e>ok</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>v</span> <span style=color:#f92672>!=</span> <span style=color:#a6e22e>carrierv1alpha1</span>.<span style=color:#a6e22e>ConditionTrue</span> {
			<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>
		}
	}
	<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>
}
</code></pre></div><p>Similarly, Squad supports graceful updates. When Squad updates and deletes GameServer, it will also check the
DeleteableGates condition.</p></div><p class="post-meta border-bottom pb-3 mb-0 mt-3">Updated on 2021-06-10</p></p><nav class="pagination mt-3"><a class="nav nav-prev" href=https://ocgi.github.io/en/docs/examples/><i class="ti-arrow-left mr-2"></i> <span class="d-none d-md-block">Examples</span></a>
<a class="nav nav-next" href=https://ocgi.github.io/zh/><span class="d-none d-md-block">Zhs</span><i class="ti-arrow-right ml-2"></i></a></nav></div></div></div></div></section><footer class="section pb-4"><div class=container><div class="row align-items-center"><div class="col-md-8 text-md-left text-center"><p class="mb-md-0 mb-4">Copyright © 2021 The OCGI Authors</p></div><div class="col-md-4 text-md-right text-center"><ul class=list-inline></ul></div></div></div></footer><script src=https://ocgi.github.io/js/script.min.js></script></body></html>